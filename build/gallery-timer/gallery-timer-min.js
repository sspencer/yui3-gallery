YUI.add("gallery-timer",function(F){var C,E="timer",D="timer",A={RUNNING:"running",PAUSED:"paused",STOPPED:"stopped"},B={START:"start",STOP:"stop",PAUSE:"pause",RESUME:"resume",TIMER:"timer"};C=function(G){C.superclass.constructor.apply(this,arguments);};F.extend(C,F.Base,{_date:new Date(),initializer:function(G){this.after("statusChange",this._statusChanged,this);this.publish(B.START,{defaultFn:this._startEvent});this.publish(B.STOP,{defaultFn:this._stopEvent});this.publish(B.PAUSE,{defaultFn:this._pauseEvent});this.publish(B.RESUME,{defaultFn:this._resumeEvent});},start:function(){if(this.get("status")!==A.RUNNING){this.fire(B.START);}return this;},stop:function(){if(this.get("status")===A.RUNNING){this.fire(B.STOP);}return this;},pause:function(){if(this.get("status")===A.RUNNING){this.fire(B.PAUSE);}return this;},resume:function(){if(this.get("status")===A.PAUSED){this.fire(B.RESUME);}return this;},_makeTimer:function(){var H=null,G=this.get("repeatCount");if(G===0||G>this.get("step")){H=F.later(this.get("length"),this,this._timer);}this.set("timer",H);this.set("start",this._date.getTime());},_destroyTimer:function(){this.get("timer").cancel();this.set("stop",this._date.getTime());this.set("step",0);},_timer:function(){this.fire(B.TIMER);var G=this.get("step"),H=this.get("repeatCount");this.set("step",++G);if(H>0&&H<=G){this.stop();}else{this._makeTimer();}(this.get("callback"))();},_statusChanged:function(G){switch(this.get("status")){case A.RUNNING:this._makeTimer();break;case A.STOPPED:case A.PAUSED:this._destroyTimer();break;}},_startEvent:function(G){this.set("status",A.RUNNING);},_stopEvent:function(G){this.set("status",A.STOPPED);},_pauseEvent:function(G){this.set("status",A.PAUSED);},_resumeEvent:function(H){var G=this.get("length")-(this.get("stop")-this.get("start"));F.later(G,this,function(){this.set("status",A.RUNNING);});}},{NAME:E,NS:D,ATTRS:{callback:{value:null,validator:F.Lang.isFunction},length:{value:3000,setter:function(G){return parseInt(G,10);}},repeatCount:{validator:function(G){return(this.get("state")===A.STOPPED);},setter:function(G){return parseInt(G,10);},value:0},start:{readonly:true},state:{value:A.STOPPED,readonly:true},step:{value:0,readonly:true},stop:{readonly:true},timer:{readonly:true}},STATUS:A,EVENTS:B});F.Timer=C;},"gallery-2010.04.14-19-47",{requires:["base","event-custom"]});